<div class="main-wrapper account-page">
  <div class="login-wrapper">
    <div class="content">
      <div class="container">
        <!-- Login Content -->
        <div class="account-content">
          <div class="align-items-center justify-content-center">
            <!-- Contenu conditionnel : formulaire ou message de succès -->
            <div *ngIf="!successSend; else successTemplate" class="login-right">
              <div class="login-header text-center">
                <h2>Mot de passe oublié</h2>
                <h3>Veuillez saisir votre adresse e-mail</h3>
              </div>
              <form [formGroup]="forgotPasswordForm">
                <div class="input-block">
                  <label for="email-address" class="focus-label"
                    >Adresse e-mail <span class="label-star"> *</span></label
                  >
                  <input
                    type="email"
                    formControlName="email"
                    class="form-control floating"
                  />
                  <div
                    class="error-message"
                    *ngIf="
                      forgotPasswordForm.get('email')?.touched &&
                      forgotPasswordForm.get('email')?.invalid
                    "
                  >
                    <small
                      class="text-danger"
                      *ngIf="forgotPasswordForm.get('email')?.errors?.['required']"
                    >
                      L'adresse e-mail est obligatoire.
                    </small>
                    <small
                      class="text-danger"
                      *ngIf="forgotPasswordForm.get('email')?.errors?.['pattern']"
                    >
                      Veuillez saisir une adresse e-mail valide.
                    </small>
                  </div>
                  <div class="error-message" *ngIf="errorMessage !== ''">
                    <small class="text-danger">
                      {{ errorMessage }}
                    </small>
                  </div>
                </div>
                <button
                  class="btn btn-primary w-100 btn-lg login-btn d-flex align-items-center justify-content-center mb-4"
                  (click)="loginFormSubmit()"
                >
                  Envoyer maintenant<i
                    class="feather icon-arrow-right ms-2"
                  ></i>
                </button>
                <div class="row">
                  <div class="d-flex mt-0 align-items-center">
                    Vous vous souvenez de votre mot de passe ?
                    <a [routerLink]="routes.login" class="ms-2 text-primary"
                      >Se connecter</a
                    >
                  </div>
                </div>
              </form>
            </div>

            <!-- Template pour le message de succès -->
            <ng-template #successTemplate>
              <div class="login-right">
                <div class="login-header text-center">
                  <div class="success-icon mb-4">
                    <i
                      class="feather icon-check-circle text-success"
                      style="font-size: 64px"
                    ></i>
                  </div>
                  <h2>E-mail envoyé</h2>
                  <div class="card-body">
                    <div class="alert alert-success" role="alert">
                      <p class="mb-0">
                        Veuillez vérifier votre boîte de réception. Un e-mail
                        contenant les instructions pour réinitialiser votre mot
                        de passe a été envoyé à l'adresse e-mail fournie.
                      </p>
                    </div>
                    <p class="mt-3">
                      Si vous ne recevez pas l'e-mail dans les prochaines
                      minutes, veuillez vérifier votre dossier de courriers
                      indésirables.
                    </p>
                    <div class="text-center mt-4">
                      <button
                        class="btn btn-outline-primary me-2"
                        (click)="
                          successSend = false; forgotPasswordForm.reset()
                        "
                      >
                        Réessayer
                      </button>
                      <a
                        [routerLink]="routes.login"
                        class="btn btn-outline-primary"
                      >
                        Retour à la connexion
                      </a>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </div>
        </div>
        <!-- /Login Content -->
      </div>
    </div>
  </div>
</div>
